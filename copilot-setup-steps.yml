name: Copilot Setup Steps
description: Pre-install dependencies for Copilot agents working on s3s

steps:
  - name: Install just
    uses: taiki-e/install-action@just
  
  - name: Setup uv
    uses: astral-sh/setup-uv@v3
    with:
      enable-cache: true
  
  - name: Setup Rust toolchain
    uses: dtolnay/rust-toolchain@stable
    with:
      components: rustfmt, clippy
  
  - name: Setup Rust cache
    uses: Swatinem/rust-cache@v2
  
  - name: Fetch dependencies
    run: |
      uv sync
      cargo fetch
    shell: bash
  
  - name: Verify setup
    run: |
      echo "Rust version: $(rustc --version)"
      echo "Cargo version: $(cargo --version)"
      echo "Just version: $(just --version)"
      echo "UV version: $(uv --version)"
      echo "Setup complete!"
    shell: bash